<!DOCTYPE html><html lang="en"><head><title>WRStat Analytics</title><link rel="shortcut icon" sizes="any" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3Cpath id='b' d='M10,105 c-31,37 84,57 101,88 c33,-22 -87,-56 -101,-88 z' stroke='%23000' stroke-width='3' /%3E%3Cpath id='t' d='M106,0 c53,42 -142,52 -98,127 c-24,-60 176,-65 98,-127 z' stroke='%23000' stroke-width='3' /%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='%23074987' /%3E%3Cg%3E%3CanimateTransform attributeName='transform' attributeType='XML' type='translate' from='0 0' to='0 170' dur='5s' begin='click' repeatCount='indefinite' /%3E%3Cuse href='%23b' x='37' y='-195' fill='%23d2ecf5' /%3E%3Cuse href='%23b' x='37' y='-25' fill='%23d2ecf5' /%3E%3Cuse href='%23b' x='37' y='-255' fill='%2374c2dd' /%3E%3Cuse href='%23b' x='37' y='-85' fill='%2374c2dd' /%3E%3Cuse href='%23b' x='37' y='85' fill='%2374c2dd' /%3E%3Cuse href='%23t' x='37' y='-85' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='-255' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='85' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='-195' fill='%23bbddff' /%3E%3Cuse href='%23t' x='37' y='-25' fill='%23bbddff' /%3E%3Cuse href='%23t' x='37' y='145' fill='%23bbddff' /%3E%3C/g%3E%3C/svg%3E" /><style type="text/css">body > div:first-child label {display: inline-block;width: 5em;text-align: right;padding-right: 1em;}body > div:first-child label:after {content: ":";}button {cursor: pointer;background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 22'%3E%3Cpath d='M1,1 l5,10 l-5,10 M6,1 l5,10 l-5,10' fill='none' stroke='%23000' /%3E%3C/svg%3E");background-repeat: no-repeat;border-width: 1px 0;border-color: #000;border-style: solid;background-color: #fff;padding: 5px 15px;transition: background-position 0.5s;}button:hover {background-position: right;}ul {list-style: none;padding: 0;}li {padding-left: 1em;}li:nth-child(2n+1) {background-color: #fff;}li:nth-child(2n) {background-color: #f9f9f9;}</style><script type="module">class t{#t=0;#s=0;#e=0;#r=0;#n=Number.MAX_SAFE_INTEGER;#i=0;get start(){return this.#n}addEvent(t){this.#t++,t.State.byUser?this.#e++:t.State.just?this.#r++:this.#s++,t.Timestamp<this.#n&&(this.#n=t.Timestamp),t.Timestamp>this.#i&&(this.#i=t.Timestamp)}addTo(t){t.#t=this.#t,t.#s+=this.#s?1:0,t.#e+=this.#e?1:0,t.#r+=this.#r?1:0,this.#n<t.#n&&(t.#n=this.#n),this.#i>t.#i&&(t.#i=this.#i)}html(){return[p(`${k(this.#n)} - ${k(this.#i)}`),g([y(S([v("Groups"),v("Users"),v("Just Disktree")])),f(S([b(this.#s+""),b(this.#e+""),b(this.#r+"")]))])]}}class s extends t{#t;constructor(t){super(),this.#t=t.sort(((t,s)=>t.Timestamp-s.Timestamp));for(const s of t)this.addEvent(s)}html(){return[super.html(),N(this.#t.map((t=>c(i({href:(O.search="?"+Object.entries(t.State).map((([t,s])=>`${t}=${JSON.stringify(s)}`)).join("&"),O.toString())},k(t.Timestamp))))))]}}class e extends t{#a=[];username;constructor(t,e){super(),this.username=t;for(const t of Object.values(e)){const e=new s(t);e.addTo(this),this.#a.push(e)}this.#a.sort(((t,s)=>t.start-s.start))}html(){return[super.html(),N(this.#a.map((t=>c(h([T(k(t.start)),t.html()])))))]}}class r extends t{#e=[];constructor(t){super(),console.log(t,Object.entries(t));for(const[s,r]of Object.entries(t)){const t=new e(s,r);t.addTo(this),this.#e.push(t)}this.#e.sort(((t,s)=>t.start-s.start))}html(){return 0===this.#e.length?u("-No Data-"):[super.html(),N(this.#e.map((t=>c(h([T(t.username),t.html()])))))]}}const n=(t,s,e)=>{const[r,n]="string"==typeof s||s instanceof Node||s instanceof Array?[{},s]:[s,e??[]];return Object.entries(r).forEach((([s,e])=>t[e instanceof Function?"addEventListener":"setAttribute"](s,e))),t.append(...[n].flat(1/0)),t},{a:i,br:a,button:o,details:h,div:u,hr:d,label:m,li:c,input:l,span:p,summary:T,table:g,tbody:f,td:b,th:v,thead:y,tr:S,ul:N}=new Proxy({},{get:(t,s)=>(t={},e)=>n(document.createElementNS("http://www.w3.org/1999/xhtml",s),t,e)}),w=(()=>{const t=(t,s)=>fetch("/"+t,{method:"POST",body:JSON.stringify(s)}).then((t=>t.json()));return{getAnalytics:(s,e)=>t("analytics",{startTime:s,endTime:e}),getHost:()=>t("host",0)}})(),O=new URL(await w.getHost()),E=(()=>{const t=new Date;return t.setDate(t.getDate()-1),t.toISOString().split("T")[0]})(),j=l({id:"startTime",type:"date",value:E}),A=l({id:"endTime",type:"date",value:E}),k=t=>new Date(1e3*t).toISOString().replace("T"," ").replace(/\..*/,""),D=u();n(document.body,[u([m({for:"startTime"},"Start Time"),j,a(),m({for:"endTime"},"End Time"),A,a(),o({click:()=>{const t=j.valueAsNumber/1e3|0,s=86400+(A.valueAsNumber/1e3|0);isNaN(t)||isNaN(s)||t>=s?alert("Invalid time range"):w.getAnalytics(t,s).then((t=>(t=>((t,s={},e)=>n((t.replaceChildren(),t),s,e))(D,new r(t).html()))(t)))}},"Go!")]),d(),D]);</script></head><body></body></html>