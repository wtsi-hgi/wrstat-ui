<!DOCTYPE html><html lang="en"><head><title>WRStat Analytics</title><link rel="shortcut icon" sizes="any" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3Cpath id='b' d='M10,105 c-31,37 84,57 101,88 c33,-22 -87,-56 -101,-88 z' stroke='%23000' stroke-width='3' /%3E%3Cpath id='t' d='M106,0 c53,42 -142,52 -98,127 c-24,-60 176,-65 98,-127 z' stroke='%23000' stroke-width='3' /%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='%23074987' /%3E%3Cg%3E%3CanimateTransform attributeName='transform' attributeType='XML' type='translate' from='0 0' to='0 170' dur='5s' begin='click' repeatCount='indefinite' /%3E%3Cuse href='%23b' x='37' y='-195' fill='%23d2ecf5' /%3E%3Cuse href='%23b' x='37' y='-25' fill='%23d2ecf5' /%3E%3Cuse href='%23b' x='37' y='-255' fill='%2374c2dd' /%3E%3Cuse href='%23b' x='37' y='-85' fill='%2374c2dd' /%3E%3Cuse href='%23b' x='37' y='85' fill='%2374c2dd' /%3E%3Cuse href='%23t' x='37' y='-85' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='-255' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='85' fill='%2374c2ff' /%3E%3Cuse href='%23t' x='37' y='-195' fill='%23bbddff' /%3E%3Cuse href='%23t' x='37' y='-25' fill='%23bbddff' /%3E%3Cuse href='%23t' x='37' y='145' fill='%23bbddff' /%3E%3C/g%3E%3C/svg%3E" /><style type="text/css">body > div:first-child label {display: inline-block;width: 5em;text-align: right;padding-right: 1em;}body > div:first-child label:after {content: ":";}button {cursor: pointer;background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 22'%3E%3Cpath d='M1,1 l5,10 l-5,10 M6,1 l5,10 l-5,10' fill='none' stroke='%23000' /%3E%3C/svg%3E");background-repeat: no-repeat;border-width: 1px 0;border-color: #000;border-style: solid;background-color: #fff;padding: 5px 15px;transition: background-position 0.5s;}button:hover {background-position: right;}ul {list-style: none;padding: 0;}li {padding-left: 1em;}li:nth-child(2n+1) {background-color: #fff;}li:nth-child(2n) {background-color: #f9f9f9;}</style><script type="module">Object.defineProperty(globalThis,"include",{value:(()=>{const t=new Map([["/code.js"]].map((([t,...e])=>[t,Object.freeze(Object.defineProperties({},Object.fromEntries(e.map((([t,e])=>[t,{enumerable:!0,get:e}])))))])));return e=>Promise.resolve(t.get(e)??import(e))})()});class t{#t=0;#e=0;#s=0;#r=0;#n=Number.MAX_SAFE_INTEGER;#i=0;get start(){return this.#n}addEvent(t){this.#t++,t.State.byUser?this.#s++:t.State.just?this.#r++:this.#e++,t.Timestamp<this.#n&&(this.#n=t.Timestamp),t.Timestamp>this.#i&&(this.#i=t.Timestamp)}addTo(t){t.#t=this.#t,t.#e+=this.#e?1:0,t.#s+=this.#s?1:0,t.#r+=this.#r?1:0,this.#n<t.#n&&(t.#n=this.#n),this.#i>t.#i&&(t.#i=this.#i)}html(){return[p(`${E(this.#n)} - ${E(this.#i)}`),b([y(O([v("Groups"),v("Users"),v("Just Disktree")])),f(O([g(this.#e+""),g(this.#s+""),g(this.#r+"")]))])]}}class e extends t{#t;constructor(t){super(),this.#t=t.sort(((t,e)=>t.Timestamp-e.Timestamp));for(const e of t)this.addEvent(e)}html(){return[super.html(),j(this.#t.map((t=>c(i({href:"https://wrstat.internal.sanger.ac.uk/?"+Object.entries(t.State).map((([t,e])=>`${t}=${JSON.stringify(e)}`)).join("&")},E(t.Timestamp))))))]}}class s extends t{#a=[];username;constructor(t,s){super(),this.username=t;for(const t of Object.values(s)){const s=new e(t);s.addTo(this),this.#a.push(s)}this.#a.sort(((t,e)=>t.start-e.start))}html(){return[super.html(),j(this.#a.map((t=>c(h([T(E(t.start)),t.html()])))))]}}class r extends t{#s=[];constructor(t){super(),console.log(t,Object.entries(t));for(const[e,r]of Object.entries(t)){const t=new s(e,r);t.addTo(this),this.#s.push(t)}this.#s.sort(((t,e)=>t.start-e.start))}html(){return 0===this.#s.length?u("-No Data-"):[super.html(),j(this.#s.map((t=>c(h([T(t.username),t.html()])))))]}}const n=(t,e,s)=>{const[r,n]="string"==typeof e||e instanceof Node||e instanceof Array?[{},e]:[e,s??[]];return Object.entries(r).forEach((([e,s])=>t[s instanceof Function?"addEventListener":"setAttribute"](e,s))),t.append(...[n].flat(1/0)),t},{a:i,br:a,button:o,details:h,div:u,hr:m,label:d,li:c,input:l,span:p,summary:T,table:b,tbody:f,td:g,th:v,thead:y,tr:O,ul:j}=new Proxy({},{get:(t,e)=>(t={},s)=>n(document.createElementNS("http://www.w3.org/1999/xhtml",e),t,s)}),N=(()=>{const t=new Date;return t.setDate(t.getDate()-1),t.toISOString().split("T")[0]})(),S=l({id:"startTime",type:"date",value:N}),w=l({id:"endTime",type:"date",value:N}),E=t=>new Date(1e3*t).toISOString().replace("T"," ").replace(/\..*/,""),k=u();n(document.body,[u([d({for:"startTime"},"Start Time"),S,a(),d({for:"endTime"},"End Time"),w,a(),o({click:()=>{const t=S.valueAsNumber/1e3|0,e=86400+(w.valueAsNumber/1e3|0);isNaN(t)||isNaN(e)||t>=e?alert("Invalid time range"):((t,e)=>{return s=JSON.stringify({startTime:t,endTime:e}),fetch("/analytics",{method:"POST",body:s}).then((t=>t.json()));var s})(t,e).then((t=>(t=>((t,e={},s)=>n((t.replaceChildren(),t),e,s))(k,new r(t).html()))(t)))}},"Go!")]),m(),k]);</script></head><body></body></html>